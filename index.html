<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ARC-V Training Academy — Year Modules</title>
<style>
  :root{
    --bg:#050608; --panel:#0f1314; --accent:#00ffd4; --muted:#8fb0a8; --card:#0b0d0e;
    --glass: rgba(255,255,255,0.02);
  }
  html,body{height:100%;margin:0;font-family:Inter,Segoe UI,system-ui,Arial;color:var(--accent);background:linear-gradient(180deg,#000 0%, #071017 60%);}
  .app{max-width:1100px;margin:24px auto;padding:20px;background:var(--glass);border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.6);}
  header{display:flex;gap:16px;align-items:center;justify-content:space-between}
  h1{margin:0;font-size:20px}
  .controls{display:flex;gap:8px;align-items:center}
  select,input{background:transparent;border:1px solid #082a24;padding:8px;border-radius:8px;color:var(--accent)}
  button{background:var(--accent);color:#041011;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
  .layout{display:grid;grid-template-columns:320px 1fr;gap:18px;margin-top:18px}
  .sidebar{background:var(--panel);padding:12px;border-radius:10px;height:72vh;overflow:auto}
  .main{background:var(--card);padding:16px;border-radius:10px;height:72vh;overflow:auto}
  .unit{padding:8px;border-radius:8px;margin-bottom:8px;border:1px solid rgba(255,255,255,0.02)}
  .unit h3{margin:0;font-size:14px}
  .lesson-list{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;margin-top:8px}
  .lesson-item{background:#07100f;padding:8px;border-radius:6px;cursor:pointer;font-size:13px}
  .lesson-item.complete{outline:2px solid rgba(0,255,208,0.12)}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:12px;border-radius:8px;margin-bottom:12px}
  .definitions{background:#061110;padding:8px;border-radius:6px}
  .quiz{margin-top:12px}
  label{display:block;margin:8px 0;font-size:14px}
  .result{margin-top:10px;padding:8px;border-radius:8px;background:#02120f;color:var(--muted)}
  footer{margin-top:10px;font-size:12px;color:var(--muted)}
  .small{font-size:13px;color:var(--muted)}
  .search{width:220px}
  .danger{background:#ff6b6b;color:#131212}
  .navbtn{background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--accent);padding:8px;border-radius:8px;cursor:pointer}
  .flex{display:flex;gap:8px;align-items:center}
  .badge{background:#022a22;padding:4px 8px;border-radius:999px;font-size:12px}
  input[type="radio"]{margin-right:8px}
  textarea{width:100%;min-height:120px;background:#061111;border:1px solid rgba(255,255,255,0.02);color:var(--accent);padding:10px;border-radius:8px}
  .muted{color:var(--muted)}
  @media(max-width:900px){.layout{grid-template-columns:1fr;}.sidebar{height:auto}.main{height:auto}}
</style>
</head>
<body>
<div class="app">
  <header>
    <div>
      <h1>ARC-V Training Academy — 12 Units × 365 Lessons</h1>
      <div class="small muted">High-level training system — lessons generated programmatically. Progress saved locally.</div>
    </div>
    <div class="controls">
      <div class="flex">
        <label class="small muted" for="unitSelect">Unit</label>
        <select id="unitSelect"></select>
      </div>
      <div class="flex">
        <label class="small muted" for="daySelect">Day</label>
        <select id="daySelect"></select>
      </div>
      <input placeholder="search lessons..." id="search" class="search" />
      <button id="gotoBtn">Go</button>
      <button id="resetProgress" class="navbtn">Reset Progress</button>
    </div>
  </header>

  <div class="layout">
    <aside class="sidebar">
      <div class="card">
        <strong>Units Overview</strong>
        <div class="small muted">Each unit contains 365 short lessons (day-based). Lessons are intentionally high-level and non-actionable.</div>
      </div>

      <div id="unitsContainer"></div>

      <div class="card">
        <strong>Progress</strong>
        <div id="progressSummary" class="small muted"></div>
        <button id="exportProgress" class="navbtn">Export Progress JSON</button>
      </div>

      <div class="card">
        <strong>Customize</strong>
        <div class="small muted">You can add a brief custom note to any lesson (saved locally).</div>
        <label>Custom note for current lesson</label>
        <textarea id="customNote" placeholder="Instructor notes..."></textarea>
        <button id="saveNote" class="navbtn">Save Note</button>
      </div>
    </aside>

    <main class="main">
      <div id="lessonView">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <h2 id="lessonTitle">Select a unit and day</h2>
              <div class="small muted" id="lessonMeta"></div>
            </div>
            <div>
              <button id="markComplete" class="navbtn">Mark Complete</button>
              <button id="prevBtn" class="navbtn">◀ Prev</button>
              <button id="nextBtn" class="navbtn">Next ▶</button>
            </div>
          </div>
        </div>

        <section id="lessonContent" class="card">
          <h3>Lesson Content</h3>
          <div id="lessonText" class="muted"></div>

          <h4>Key Definitions</h4>
          <div id="definitions" class="definitions"></div>

          <div id="customNoteDisplay" class="muted small" style="margin-top:8px"></div>

          <div class="quiz card" id="quizArea">
            <h3>Quick Quiz</h3>
            <div id="quizQuestions"></div>
            <button id="submitQuiz" class="navbtn">Submit Answers</button>
            <div id="quizResult" class="result" style="display:none"></div>
          </div>
        </section>

        <section id="footerNotes" class="card small muted">
          <strong>Safety:</strong> Lesson content is purposely non-actionable. This system is a learning scaffold — do not use it for planning or executing harmful or illegal activities.
        </section>
      </div>
    </main>
  </div>

  <footer class="small muted">ARC-V Academy generator — Lessons created from templates. Data saved to <code>localStorage</code>.</footer>
</div>

<script>
/* -------------------------
  Configuration: 12 Units
   - Each unit has 365 lessons (day 1..365)
   - Lesson text and quizzes generated from templates.
   - Quizzes are deterministic per unit/day (seeded).
   - Progress + custom notes saved in localStorage.
--------------------------*/

const UNIT_COUNT = 12;
const LESSONS_PER_UNIT = 365;
const STORAGE_KEY = 'arcv_academy_progress_v1';

// Safe high-level unit topics. Avoid operational details.
const UNITS = [
  { id:1, short:'Foundations', title:'Unit 1 — Core Agent Foundations', desc:'Discipline, mindset, observation, communication, and ethics.' },
  { id:2, short:'Awareness', title:'Unit 2 — Situational Awareness & Stealth (non-actionable)', desc:'Awareness, camouflage principles (conceptual), minimizing exposure in lawful contexts.' },
  { id:3, short:'Intel', title:'Unit 3 — Intelligence & Analysis', desc:'Collecting lawful information, evaluating sources, bias, corroboration, pattern recognition.' },
  { id:4, short:'Comm', title:'Unit 4 — Communications & Encryption Concepts', desc:'Secure thinking: privacy principles, password hygiene, high-level cryptography concepts (no tools/instructions).' },
  { id:5, short:'Fitness', title:'Unit 5 — Fitness & Resilience', desc:'Physical conditioning basics, recovery, mental resilience (safe, general fitness).' },
  { id:6, short:'Cyber', title:'Unit 6 — Cybersecurity Awareness', desc:'Phishing awareness, safe browsing, incident reporting, do not include exploit instructions.' },
  { id:7, short:'Tactics', title:'Unit 7 — Tactical Decision-Making (theory)', desc:'Decision frameworks, OODA loop, risk assessment — conceptual and ethical.' },
  { id:8, short:'Medical', title:'Unit 8 — Medical & First Aid', desc:'Basic first aid, stabilization, when to call emergency services; non-invasive instructions only.' },
  { id:9, short:'Leadership', title:'Unit 9 — Leadership & Teamwork', desc:'Command, delegation, feedback, debriefs, building trust and morale.' },
  { id:10, short:'Tech', title:'Unit 10 — Technology Literacy', desc:'Drones, sensors, robotics — high-level understanding, ethics and safety.' },
  { id:11, short:'Law', title:'Unit 11 — Law, Ethics & Accountability', desc:'Legal frameworks, rules of engagement, reporting obligations, ethical reasoning.' },
  { id:12, short:'Capstone', title:'Unit 12 — Capstone, Review & Scenario Practice (safe)', desc:'Case studies, simulated high-level problem solving with ethical constraints.' }
];

// ---------- Utility functions ----------
function saveProgress(progress) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
}
function loadProgress() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if(!raw) return { completed: {}, notes: {}, quizHistory: {} };
  try { return JSON.parse(raw); } catch(e) { return { completed: {}, notes: {}, quizHistory: {} };}
}
const progress = loadProgress();

function uid(unit, day){ return `u${unit}d${day}`; }

// deterministic pseudo-random for quizzes based on unit/day
function seededRandom(seed) {
  let s = seed >>> 0;
  return function() {
    s = Math.imul(1664525, s) + 1013904223;
    return ((s >>> 0) / 4294967296);
  };
}

// basic safe templating for lesson text (non-actionable)
function generateLessonText(unitIndex, day){
  const unit = UNITS[unitIndex-1];
  const rnd = seededRandom(unitIndex * 1000 + day);
  const intros = [
    `Overview and key ideas for ${unit.short}.`,
    `Concepts and principles related to ${unit.short}.`,
    `A concise lesson exploring ${unit.short} fundamentals.`
  ];
  const focuses = [
    'mindset & discipline',
    'observation & reporting',
    'ethical decision-making',
    'team coordination',
    'risk awareness & mitigation (non-actionable)',
    'self-care and resilience'
  ];
  const chosenIntro = intros[Math.floor(rnd()*intros.length)];
  const chosenFocus = focuses[Math.floor(rnd()*focuses.length)];
  const paragraphs = [
    `${chosenIntro} — Day ${day} of Unit ${unitIndex}. This lesson focuses on ${chosenFocus} within the context of ${unit.title}.`,
    `Key points: reflect, document, and practice conceptual approaches. Avoid operational or unsafe techniques; prioritize legality and safety.`,
    `Reflection prompt: How does this idea relate to your previous lessons? Write a short summary in the notes area.`
  ];
  return paragraphs.join('\n\n');
}

// safe definitions generator
function generateDefinitions(unitIndex, day){
  const defs = [];
  const rnd = seededRandom(unitIndex * 1000 + day + 7);
  const pool = [
    ['Discipline','Consistent commitment to training, routine, and standards of conduct.'],
    ['Situational Awareness','The habit of noticing surroundings and changes; used for safety and reporting.'],
    ['Corroboration','Confirming information with multiple independent, lawful sources.'],
    ['Operational Security (OPSEC)','A principle: share the least information necessary and follow applicable laws/policies.'],
    ['Ethical Reasoning','Using moral principles and rules to choose acceptable actions.'],
    ['Deconfliction','Ensuring activities don’t interfere with others; communication and planning to avoid collisions.'],
    ['Resilience','Physical and mental ability to recover from stress safely.'],
    ['Chain of Custody','Documenting evidence or material handling in legal/ethical contexts (high-level concept).'],
  ];
  // pick 3-4 defs
  const picks = new Set();
  while(picks.size < 4){
    picks.add(Math.floor(rnd()*pool.length));
  }
  for(let idx of picks) defs.push({term:pool[idx][0], definition:pool[idx][1]});
  return defs;
}

// generate a short 3-question quiz: multiple-choice (one correct). Questions are conceptual.
function generateQuiz(unitIndex, day){
  const rnd = seededRandom(unitIndex * 1000 + day + 999);
  // simple templates: ensure safe content
  const qPool = [
    {
      q: (u,d) => `What is a safe first step when noticing unusual information during a task in Unit ${u}?`,
      choices: ['Ignore it and continue','Document it & report through proper channels','Share widely on social media'],
      answer: 1
    },
    {
      q: (u,d) => `Which best describes "corroboration"?`,
      choices: ['Using one source only','Confirming information using multiple independent sources','Assuming information is true if it sounds plausible'],
      answer: 1
    },
    {
      q: (u,d) => `What is the main purpose of a debrief?`,
      choices: ['To assign blame only','To extract lessons and improve future decisions','To celebrate without analysis'],
      answer: 1
    },
    {
      q: (u,d) => `When encountering a technical cybersecurity concern, what is the responsible action?`,
      choices: ['Attempt to hack back','Report to appropriate IT/security team','Post details publicly to get help'],
      answer: 1
    },
    {
      q: (u,d) => `Which is a key element of resilience?`,
      choices: ['Ignoring stressors','Practicing recovery and rest','Pushing without breaks'],
      answer: 1
    },
    {
      q: (u,d) => `What should you prioritize when a teammate asks for help?`,
      choices: ['Immediate assessment and safe escalation','Publicly criticize them','Share confidential info without permission'],
      answer: 0
    }
  ];
  // pick three distinct questions
  const idxs = new Set();
  while(idxs.size < 3) idxs.add(Math.floor(rnd()*qPool.length));
  const out = [];
  for(let i of idxs){
    const qObj = qPool[i];
    out.push({
      text: qObj.q(unitIndex, day),
      choices: qObj.choices,
      answerIndex: qObj.answer
    });
  }
  return out;
}

// ---------- UI wiring ----------
const unitSelect = document.getElementById('unitSelect');
const daySelect = document.getElementById('daySelect');
const unitsContainer = document.getElementById('unitsContainer');
const lessonTitle = document.getElementById('lessonTitle');
const lessonMeta = document.getElementById('lessonMeta');
const lessonText = document.getElementById('lessonText');
const definitionsDiv = document.getElementById('definitions');
const quizQuestionsDiv = document.getElementById('quizQuestions');
const quizResultDiv = document.getElementById('quizResult');
const submitQuizBtn = document.getElementById('submitQuiz');
const markCompleteBtn = document.getElementById('markComplete');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const searchInput = document.getElementById('search');
const gotoBtn = document.getElementById('gotoBtn');
const progressSummary = document.getElementById('progressSummary');
const exportProgressBtn = document.getElementById('exportProgress');
const resetProgressBtn = document.getElementById('resetProgress');
const unitsContainerEl = document.getElementById('unitsContainer');
const customNoteArea = document.getElementById('customNote');
const saveNoteBtn = document.getElementById('saveNote');
const customNoteDisplay = document.getElementById('customNoteDisplay');

let currentUnit = 1;
let currentDay = 1;
let currentQuiz = null;

// populate unit and day selects
function initSelectors(){
  for(let i=1;i<=UNIT_COUNT;i++){
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = `${i}. ${UNITS[i-1].short}`;
    unitSelect.appendChild(opt);
  }
  for(let d=1;d<=LESSONS_PER_UNIT;d++){
    const opt = document.createElement('option');
    opt.value = d;
    opt.textContent = `Day ${d}`;
    daySelect.appendChild(opt);
  }
  unitSelect.value = currentUnit;
  daySelect.value = currentDay;
}
initSelectors();

// build sidebar unit blocks (show a few recent lessons and completion summary)
function renderUnitsSidebar(){
  unitsContainerEl.innerHTML = '';
  for(let i=1;i<=UNIT_COUNT;i++){
    const u = UNITS[i-1];
    const div = document.createElement('div');
    div.className='unit';
    const h = document.createElement('h3');
    h.innerText = `${i}. ${u.title}`;
    div.appendChild(h);
    const desc = document.createElement('div');
    desc.className='small muted';
    desc.innerText = u.desc;
    div.appendChild(desc);

    // show mini progress stats
    const completedCount = Object.keys(progress.completed).filter(k=>k.startsWith(`u${i}d`)).length;
    const stat = document.createElement('div');
    stat.className='small';
    stat.style.marginTop='6px';
    stat.innerHTML = `<span class="badge">${completedCount}/${LESSONS_PER_UNIT}</span> completed`;
    div.appendChild(stat);

    // quick jump: recent days list
    const lessonList = document.createElement('div');
    lessonList.className='lesson-list';
    for(let d=1; d<=6; d++){
      const li = document.createElement('div');
      li.className='lesson-item';
      const dayNum = d;
      const key = uid(i, dayNum);
      if(progress.completed[key]) li.classList.add('complete');
      li.innerText = `Day ${dayNum}`;
      li.onclick = ()=>{ goToLesson(i, dayNum); };
      lessonList.appendChild(li);
    }
    div.appendChild(lessonList);
    unitsContainerEl.appendChild(div);
  }
  updateProgressSummary();
}

function updateProgressSummary(){
  const totalCompleted = Object.keys(progress.completed).length;
  const totalLessons = UNIT_COUNT * LESSONS_PER_UNIT;
  progressSummary.innerText = `${totalCompleted} of ${totalLessons} lessons completed.`;
}

// load and render a lesson
function renderLesson(unit, day){
  currentUnit = Number(unit);
  currentDay = Number(day);
  unitSelect.value = currentUnit;
  daySelect.value = currentDay;

  lessonTitle.innerText = `${UNITS[currentUnit-1].short} — Day ${currentDay}`;
  lessonMeta.innerText = `${UNITS[currentUnit-1].title} • ${UNITS[currentUnit-1].desc}`;
  lessonText.innerText = generateLessonText(currentUnit, currentDay);

  // definitions
  const defs = generateDefinitions(currentUnit, currentDay);
  definitionsDiv.innerHTML = '';
  for(const d of defs){
    const el = document.createElement('div');
    el.style.marginBottom='8px';
    el.innerHTML = `<strong style="color:var(--accent)">${d.term}</strong>: <span class="muted">${d.definition}</span>`;
    definitionsDiv.appendChild(el);
  }

  // custom note
  const key = uid(currentUnit,currentDay);
  customNoteArea.value = progress.notes && progress.notes[key] ? progress.notes[key] : '';
  customNoteDisplay.innerText = progress.notes && progress.notes[key] ? `Instructor note: ${progress.notes[key]}` : '';

  // quiz generation
  currentQuiz = generateQuiz(currentUnit, currentDay);
  quizQuestionsDiv.innerHTML = '';
  currentQuiz.forEach((q, qi)=>{
    const qdiv = document.createElement('div');
    qdiv.className='small';
    qdiv.style.marginBottom='10px';
    const qtitle = document.createElement('div');
    qtitle.innerText = `${qi+1}. ${q.text}`;
    qdiv.appendChild(qtitle);
    q.choices.forEach((c, ci)=>{
      const id = `q${qi}_c${ci}`;
      const label = document.createElement('label');
      label.innerHTML = `<input type="radio" name="q${qi}" value="${ci}" id="${id}" /> ${c}`;
      qdiv.appendChild(label);
    });
    quizQuestionsDiv.appendChild(qdiv);
  });
  quizResultDiv.style.display='none';
  renderUnitsSidebar();
}

// navigation
function goToLesson(unit, day){
  renderLesson(unit, day);
}

unitSelect.onchange = ()=> goToLesson(unitSelect.value, daySelect.value);
daySelect.onchange = ()=> goToLesson(unitSelect.value, daySelect.value);

prevBtn.onclick = ()=>{
  let d = currentDay-1;
  let u = currentUnit;
  if(d < 1){ if(u>1){ u--; d = LESSONS_PER_UNIT;} else {return;} }
  goToLesson(u,d);
};
nextBtn.onclick = ()=>{
  let d = currentDay+1;
  let u = currentUnit;
  if(d > LESSONS_PER_UNIT){ if(u<UNIT_COUNT){ u++; d = 1;} else {return;} }
  goToLesson(u,d);
};

// mark complete
markCompleteBtn.onclick = ()=>{
  const key = uid(currentUnit,currentDay);
  progress.completed[key] = { timestamp: Date.now() };
  saveProgress(progress);
  renderLesson(currentUnit,currentDay);
};

// submit quiz
submitQuizBtn.onclick = ()=>{
  const answers = [];
  for(let i=0;i<currentQuiz.length;i++){
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    answers.push(sel ? Number(sel.value) : null);
  }
  let score=0;
  const feedback = [];
  currentQuiz.forEach((q, i)=>{
    const correct = q.answerIndex;
    const got = answers[i];
    if(got === correct) score++;
    feedback.push({ q:q.text, correct: q.choices[correct], got: got===null ? 'No answer' : q.choices[got] });
  });

  quizResultDiv.style.display='block';
  quizResultDiv.innerHTML = `<strong>Score: ${score}/${currentQuiz.length}</strong><br/><br/>` +
    feedback.map((f,idx)=>`Q${idx+1}: Correct — <em>${f.correct}</em>; You — <em>${f.got}</em>`).join('<br/>');

  // store in history
  const histKey = uid(currentUnit,currentDay);
  if(!progress.quizHistory) progress.quizHistory = {};
  progress.quizHistory[histKey] = { timestamp: Date.now(), score, total: currentQuiz.length, answers: answers };
  saveProgress(progress);
  renderUnitsSidebar();
};

// search/goto
gotoBtn.onclick = ()=>{
  const s = searchInput.value.trim().toLowerCase();
  if(!s) return alert('Type a term like "resilience" or "unit 3 day 20".');
  // try to parse "unit X day Y"
  const ud = s.match(/unit\s*(\d+)\s*day\s*(\d+)/i);
  if(ud){ const u = Number(ud[1]); const d=Number(ud[2]); if(u>=1 && u<=UNIT_COUNT && d>=1 && d<=LESSONS_PER_UNIT){ goToLesson(u,d); return; } }
  // otherwise do a naive search by generating and checking a small sample range (to avoid generating all 4380 lessons)
  for(let u=1;u<=UNIT_COUNT;u++){
    for(let d=1; d<=LESSONS_PER_UNIT; d++){
      // check lesson text headings and definitions for match (but do it in chunks to avoid blocking)
      const txt = (generateLessonText(u,d) + ' ' + generateDefinitions(u,d).map(x=>x.term+' '+x.definition).join(' ')).toLowerCase();
      if(txt.includes(s)){ goToLesson(u,d); return; }
      // To keep UI responsive only search first 400 lessons; if no match, notify user to refine search.
      if(u*LESSONS_PER_UNIT + d > 400) break;
    }
    if(u*LESSONS_PER_UNIT > 400) break;
  }
  alert('Quick search scanned a portion of lessons. For wide search, refine (e.g., "unit 3 day 5" or search short keywords).');
};

// export progress
exportProgressBtn.onclick = ()=>{
  const dataStr = JSON.stringify(progress, null, 2);
  const blob = new Blob([dataStr], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'arcv_progress.json'; a.click();
  URL.revokeObjectURL(url);
};

// reset
resetProgressBtn.onclick = ()=>{
  if(!confirm('Reset all saved progress and notes?')) return;
  localStorage.removeItem(STORAGE_KEY);
  location.reload();
};

// save custom note
saveNoteBtn.onclick = ()=>{
  const key = uid(currentUnit,currentDay);
  if(!progress.notes) progress.notes = {};
  const txt = customNoteArea.value.trim();
  if(txt.length===0) { delete progress.notes[key]; } else { progress.notes[key] = txt; }
  saveProgress(progress);
  customNoteDisplay.innerText = txt ? `Instructor note: ${txt}` : '';
  alert('Note saved locally.');
};

// initial render
renderLesson(currentUnit, currentDay);

/* Performance note:
   - Lessons are generated on the fly. We avoid pre-allocating huge arrays.
   - Progress, notes, and quiz history are saved in localStorage.
*/

/* Developer: If you want to replace templates with real content:
   - Provide a JSON file keyed by "u{n}d{m}" and change generateLessonText/generateDefinitions/generateQuiz to pull from it.
*/

</script>
</body>
</html>
